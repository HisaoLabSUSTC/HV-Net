function f = int_of_power_of_sin(m, a, b)
f = cal_int(b, m) - cal_int(a, m);

function f = cal_int(x, m)
switch m
    case 0
        f = x;
    case 1
        f = -cos(x);
    case 2
        f = x/2 - sin(2*x)/4;
    case 3
        f = (cos(x)*(cos(x)^2 - 3))/3;
    case 4
        f = (3*x)/8 - sin(2*x)/4 + sin(4*x)/32;
    case 5
        f = (2*cos(x)^3)/3 - cos(x) - cos(x)^5/5;
    case 6
        f = (5*x)/16 - (15*sin(2*x))/64 + (3*sin(4*x))/64 - sin(6*x)/192;
    case 7
        f = (7*cos(3*x))/64 - (7*cos(5*x))/320 + cos(7*x)/448 - (35*cos(x))/64;
    case 8
        f = (35*x)/128 - (7*sin(2*x))/32 + (7*sin(4*x))/128 - sin(6*x)/96 + sin(8*x)/1024;
    case 9
        f = (7*cos(3*x))/64 - (9*cos(5*x))/320 + (9*cos(7*x))/1792 - cos(9*x)/2304 - (63*cos(x))/128;
    case 10
        f = (63*x)/256 - (105*sin(2*x))/512 + (15*sin(4*x))/256 - (15*sin(6*x))/1024 + (5*sin(8*x))/2048 - sin(10*x)/5120;
    case 11
        f = (55*cos(3*x))/512 - (33*cos(5*x))/1024 + (55*cos(7*x))/7168 - (11*cos(9*x))/9216 + cos(11*x)/11264 - (231*cos(x))/512;
    case 12
        f = (231*x)/1024 - (99*sin(2*x))/512 + (495*sin(4*x))/8192 - (55*sin(6*x))/3072 + (33*sin(8*x))/8192 - (3*sin(10*x))/5120 + sin(12*x)/24576;
    case 13
        f = (429*cos(3*x))/4096 - (143*cos(5*x))/4096 + (143*cos(7*x))/14336 - (13*cos(9*x))/6144 + (13*cos(11*x))/45056 - cos(13*x)/53248 - (429*cos(x))/1024;
    case 14
        f = (429*x)/2048 - (3003*sin(2*x))/16384 + (1001*sin(4*x))/16384 - (1001*sin(6*x))/49152 + (91*sin(8*x))/16384 - (91*sin(10*x))/81920 + (7*sin(12*x))/49152 - sin(14*x)/114688;
    case 15
        f = (5005*cos(3*x))/49152 - (3003*cos(5*x))/81920 + (195*cos(7*x))/16384 - (455*cos(9*x))/147456 + (105*cos(11*x))/180224 - (15*cos(13*x))/212992 + cos(15*x)/245760 - (6435*cos(x))/16384;
    case 16
        f = (6435*x)/32768 - (715*sin(2*x))/4096 + (1001*sin(4*x))/16384 - (91*sin(6*x))/4096 + (455*sin(8*x))/65536 - (7*sin(10*x))/4096 + (5*sin(12*x))/16384 - sin(14*x)/28672 + sin(16*x)/524288;
    case 17
        f = (2431*cos(3*x))/24576 - (1547*cos(5*x))/40960 + (221*cos(7*x))/16384 - (595*cos(9*x))/147456 + (85*cos(11*x))/90112 - (17*cos(13*x))/106496 + (17*cos(15*x))/983040 - cos(17*x)/1114112 - (12155*cos(x))/32768;
    case 18
        f = (12155*x)/65536 - (21879*sin(2*x))/131072 + (1989*sin(4*x))/32768 - (1547*sin(6*x))/65536 + (1071*sin(8*x))/131072 - (153*sin(10*x))/65536 + (17*sin(12*x))/32768 - (153*sin(14*x))/1835008 + (9*sin(16*x))/1048576 - sin(18*x)/2359296;
    case 19
        f = (12597*cos(3*x))/131072 - (12597*cos(5*x))/327680 + (969*cos(7*x))/65536 - (323*cos(9*x))/65536 + (969*cos(11*x))/720896 - (969*cos(13*x))/3407872 + (57*cos(15*x))/1310720 - (19*cos(17*x))/4456448 + cos(19*x)/4980736 - (46189*cos(x))/131072;
    case 20
        f = (46189*x)/262144 - (20995*sin(2*x))/131072 + (62985*sin(4*x))/1048576 - (1615*sin(6*x))/65536 + (4845*sin(8*x))/524288 - (969*sin(10*x))/327680 + (1615*sin(12*x))/2097152 - (285*sin(14*x))/1835008 + (95*sin(16*x))/4194304 - (5*sin(18*x))/2359296 + sin(20*x)/10485760;
    case 21
        f = (146965*cos(3*x))/1572864 - (20349*cos(5*x))/524288 + (14535*cos(7*x))/917504 - (2261*cos(9*x))/393216 + (20349*cos(11*x))/11534336 - (5985*cos(13*x))/13631488 + (133*cos(15*x))/1572864 - (105*cos(17*x))/8912896 + (21*cos(19*x))/19922944 - cos(21*x)/22020096 - (88179*cos(x))/262144;
    case 22
        f = (88179*x)/524288 - (323323*sin(2*x))/2097152 + (124355*sin(4*x))/2097152 - (53295*sin(6*x))/2097152 + (10659*sin(8*x))/1048576 - (74613*sin(10*x))/20971520 + (4389*sin(12*x))/4194304 - (1045*sin(14*x))/4194304 + (385*sin(16*x))/8388608 - (77*sin(18*x))/12582912 + (11*sin(20*x))/20971520 - sin(22*x)/46137344;
    case 23
        f = (572033*cos(3*x))/6291456 - (81719*cos(5*x))/2097152 + (245157*cos(7*x))/14680064 - (81719*cos(9*x))/12582912 + (9177*cos(11*x))/4194304 - (33649*cos(13*x))/54525952 + (1771*cos(15*x))/12582912 - (1771*cos(17*x))/71303168 + (253*cos(19*x))/79691776 - (23*cos(21*x))/88080384 + cos(23*x)/96468992 - (676039*cos(x))/2097152;
    case 24
        f = (676039*x)/4194304 - (156009*sin(2*x))/1048576 + (245157*sin(4*x))/4194304 - (81719*sin(6*x))/3145728 + (735471*sin(8*x))/67108864 - (43263*sin(10*x))/10485760 + (33649*sin(12*x))/25165824 - (759*sin(14*x))/2097152 + (5313*sin(16*x))/67108864 - (253*sin(18*x))/18874368 + (69*sin(20*x))/41943040 - (3*sin(22*x))/23068672 + sin(24*x)/201326592;
    case 25
        f = (185725*cos(3*x))/2097152 - (81719*cos(5*x))/2097152 + (2042975*cos(7*x))/117440512 - (120175*cos(9*x))/16777216 + (10925*cos(11*x))/4194304 - (44275*cos(13*x))/54525952 + (1771*cos(15*x))/8388608 - (6325*cos(17*x))/142606336 + (575*cos(19*x))/79691776 - (25*cos(21*x))/29360128 + (25*cos(23*x))/385875968 - cos(25*x)/419430400 - (1300075*cos(x))/4194304;
    case 26
        f = (1300075*x)/8388608 - (2414425*sin(2*x))/16777216 + (482885*sin(4*x))/8388608 - (5311735*sin(6*x))/201326592 + (1562275*sin(8*x))/134217728 - (312455*sin(10*x))/67108864 + (82225*sin(12*x))/50331648 - (16445*sin(14*x))/33554432 + (16445*sin(16*x))/134217728 - (7475*sin(18*x))/301989888 + (65*sin(20*x))/16777216 - (325*sin(22*x))/738197504 + (13*sin(24*x))/402653184 - sin(26*x)/872415232;
    case 27
        f = (1448655*cos(3*x))/16777216 - (2607579*cos(5*x))/67108864 + (8436285*cos(7*x))/469762048 - (1562275*cos(9*x))/201326592 + (201825*cos(11*x))/67108864 - (34155*cos(13*x))/33554432 + (9867*cos(15*x))/33554432 - (40365*cos(17*x))/570425344 + (8775*cos(19*x))/637534208 - (975*cos(21*x))/469762048 + (351*cos(23*x))/1543503872 - (27*cos(25*x))/1677721600 + cos(27*x)/1811939328 - (5014575*cos(x))/16777216;
    case 28
        f = (5014575*x)/33554432 - (2340135*sin(2*x))/16777216 + (30421755*sin(4*x))/536870912 - (1789515*sin(6*x))/67108864 + (6561555*sin(8*x))/536870912 - (345345*sin(10*x))/67108864 + (1036035*sin(12*x))/536870912 - (148005*sin(14*x))/234881024 + (94185*sin(16*x))/536870912 - (1365*sin(18*x))/33554432 + (4095*sin(20*x))/536870912 - (819*sin(22*x))/738197504 + (63*sin(24*x))/536870912 - (7*sin(26*x))/872415232 + sin(28*x)/3758096384;
    case 29
        f = (22621305*cos(3*x))/268435456 - (10379187*cos(5*x))/268435456 + (2471235*cos(7*x))/134217728 - (3338335*cos(9*x))/402653184 + (910455*cos(11*x))/268435456 - (330165*cos(13*x))/268435456 + (26013*cos(15*x))/67108864 - (118755*cos(17*x))/1140850688 + (118755*cos(19*x))/5100273664 - (1131*cos(21*x))/268435456 + (1827*cos(23*x))/3087007744 - (203*cos(25*x))/3355443200 + (29*cos(27*x))/7247757312 - cos(29*x)/7784628224 - (9694845*cos(x))/33554432;
    case 30
        f = (9694845*x)/67108864 - (145422675*sin(2*x))/1073741824 + (59879925*sin(4*x))/1073741824 - (28831075*sin(6*x))/1073741824 + (13656825*sin(8*x))/1073741824 - (6009003*sin(10*x))/1073741824 + (2384525*sin(12*x))/1073741824 - (5852925*sin(14*x))/7516192768 + (254475*sin(16*x))/1073741824 - (65975*sin(18*x))/1073741824 + (71253*sin(20*x))/5368709120 - (27405*sin(22*x))/11811160064 + (1015*sin(24*x))/3221225472 - (435*sin(26*x))/13958643712 + (15*sin(28*x))/7516192768 - sin(30*x)/16106127360;
    otherwise
        f = 0;
end
